<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MEET | Profile</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  /* --- General Styles --- */
  body { font-family: 'Poppins', sans-serif; margin: 0; background-color: #f5f5f5; color: #333; }
  .dark-mode { background-color: #121212; color: #e0e0e0; }
  button { cursor: pointer; }
  .container { max-width: 1000px; margin: auto; padding: 20px; }

  /* --- Profile Header --- */
  .profile-header { position: relative; text-align: center; margin-bottom: 20px; }
  .cover-photo { width: 100%; height: 250px; object-fit: cover; border-radius: 8px; cursor: pointer; }
  .profile-picture { width: 120px; height: 120px; border-radius: 50%; border: 4px solid #fff; position: absolute; bottom: -60px; left: 50%; transform: translateX(-50%); cursor: pointer; }
  .edit-btn { margin-top: 80px; padding: 8px 16px; background-color: #007bff; color: #fff; border: none; border-radius: 4px; }

  /* --- Modals --- */
  .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.6); justify-content: center; align-items: center; z-index: 1000; }
  .modal-content { background: #fff; padding: 20px; border-radius: 8px; max-width: 500px; width: 100%; position: relative; }
  .modal-content img { max-width: 100%; border-radius: 8px; }
  .close { position: absolute; top: 10px; right: 15px; cursor: pointer; font-size: 20px; }
  .form-group { margin-bottom: 15px; }
  .form-group label { display: block; margin-bottom: 5px; }
  .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc; }

  /* --- Privacy Selector --- */
  .privacy-selector { display: flex; gap: 10px; margin-top: 5px; }
  .privacy-option { padding: 5px 10px; border-radius: 4px; border: 1px solid #ccc; cursor: pointer; }
  .privacy-option.active { background-color: #007bff; color: #fff; border-color: #007bff; }

  /* --- Posts Grid --- */
  .posts-grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(150px,1fr)); gap: 15px; margin-top: 20px; }
  .post-thumbnail { position: relative; background: #eee; border-radius: 8px; overflow: hidden; cursor: pointer; }
  .post-thumbnail img, .post-thumbnail video { width: 100%; height: 150px; object-fit: cover; }
  .private-badge { position: absolute; top: 5px; left: 5px; background: rgba(0,0,0,0.7); color: #fff; padding: 2px 6px; border-radius: 3px; font-size: 12px; }
  .post-stats-overlay { position: absolute; bottom: 0; left:0; right:0; background: rgba(0,0,0,0.5); color: #fff; display: flex; justify-content: space-around; padding: 3px 0; font-size: 12px; }

  /* --- Loading Message --- */
  .loading { text-align: center; padding: 20px; color: #555; }
  .error-message { color: red; text-align: center; padding: 10px; }

  /* --- Theme Toggle --- */
  .theme-toggle { position: fixed; bottom: 20px; right: 20px; padding: 8px 12px; background: #007bff; color: #fff; border-radius: 4px; border: none; cursor: pointer; }
</style>
</head>
<body>

<div class="container">
  <!-- Profile Header -->
  <div class="profile-header">
    <img id="coverPhoto" class="cover-photo" src="https://via.placeholder.com/1000x250" alt="Cover Photo">
    <img id="profilePicture" class="profile-picture" src="https://via.placeholder.com/120" alt="Profile Picture">
    <button id="editProfileBtn" class="edit-btn">Edit Profile</button>
  </div>

  <!-- Posts Grid -->
  <div id="postsGrid" class="posts-grid"></div>

  <!-- Theme Toggle -->
  <button id="nightToggleBtn" class="theme-toggle"><i class="fas fa-moon"></i> Night Mode</button>

  <!-- Modals -->

  <!-- Edit Profile Modal -->
  <div id="editProfileModal" class="modal">
    <div class="modal-content">
      <span id="closeEditModal" class="close">&times;</span>
      <h3>Edit Profile</h3>
      <form id="profileForm">
        <div class="form-group">
          <label for="fullName">Full Name</label>
          <input type="text" id="fullName" required>
        </div>
        <div class="form-group">
          <label for="bio">Bio</label>
          <textarea id="bio"></textarea>
        </div>
        <div class="form-group">
          <label for="dob">Date of Birth</label>
          <input type="date" id="dob">
        </div>
        <div class="form-group">
          <label>Privacy Settings</label>
          <div class="privacy-selector" data-field="dob">
            <div class="privacy-option" data-privacy="public">Public</div>
            <div class="privacy-option" data-privacy="friends">Friends</div>
            <div class="privacy-option" data-privacy="private">Private</div>
          </div>
        </div>
        <button type="submit">Save Changes</button>
      </form>
    </div>
  </div>

  <!-- Image Upload Modal -->
  <div id="imageUploadModal" class="modal">
    <div class="modal-content">
      <span id="closeImageModal" class="close">&times;</span>
      <h3 id="imageUploadTitle">Upload Image</h3>
      <div id="imageUploadArea" style="border:2px dashed #ccc; padding:20px; text-align:center; cursor:pointer;">
        Click here or drag to upload
      </div>
      <input type="file" id="imageUploadInput" style="display:none;">
      <div id="imagePreview" style="margin-top:10px;"></div>
      <button id="uploadImageBtn" style="margin-top:10px;">Upload</button>
    </div>
  </div>

  <!-- Image View Modal -->
  <div id="imageViewModal" class="modal">
    <div class="modal-content">
      <span id="closeImageViewModal" class="close">&times;</span>
      <img id="viewedImage" src="" alt="View Image">
    </div>
  </div>
</div>

<script>
  // --- Mock Variables ---
  let privacySettings = { dob: 'public' };
  let userProfile = {};
  let userSkills = [];
  let currentUploadType = '';
  let currentUser = { uid: 'user123', displayName: 'John Doe' }; // Mock auth
  const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB

  // --- Elements ---
  const editProfileBtn = document.getElementById('editProfileBtn');
  const editProfileModal = document.getElementById('editProfileModal');
  const closeEditModal = document.getElementById('closeEditModal');
  const profileForm = document.getElementById('profileForm');
  const coverPhoto = document.getElementById('coverPhoto');
  const profilePicture = document.getElementById('profilePicture');
  const imageUploadModal = document.getElementById('imageUploadModal');
  const closeImageModal = document.getElementById('closeImageModal');
  const imageUploadInput = document.getElementById('imageUploadInput');
  const imageUploadArea = document.getElementById('imageUploadArea');
  const imagePreview = document.getElementById('imagePreview');
  const uploadImageBtn = document.getElementById('uploadImageBtn');
  const imageViewModal = document.getElementById('imageViewModal');
  const closeImageViewModal = document.getElementById('closeImageViewModal');
  const viewedImage = document.getElementById('viewedImage');
  const nightToggleBtn = document.getElementById('nightToggleBtn');
  const postsGrid = document.getElementById('postsGrid');

  function showMessage(msg, type='error') { alert(msg); }

  function setLoading(btnId, isLoading) { 
    const btn = document.getElementById(btnId);
    if(btn) btn.textContent = isLoading ? 'Loading...' : btn.dataset.original || btn.textContent; 
  }

  function initPrivacySelectors() {
    document.querySelectorAll('.privacy-selector').forEach(selector => {
      const options = selector.querySelectorAll('.privacy-option');
      const field = selector.getAttribute('data-field');

      if (privacySettings[field]) {
        options.forEach(opt => opt.classList.remove('active'));
        const activeOption = selector.querySelector(`.privacy-option[data-privacy="${privacySettings[field]}"]`);
        if (activeOption) activeOption.classList.add('active');
      }

      options.forEach(option => {
        option.addEventListener('click', () => {
          options.forEach(opt => opt.classList.remove('active'));
          option.classList.add('active');
          privacySettings[field] = option.getAttribute('data-privacy');
        });
      });
    });
  }

  function populateEditForm() {
    document.getElementById('fullName').value = userProfile.fullName || '';
    document.getElementById('bio').value = userProfile.bio || '';
    document.getElementById('dob').value = userProfile.dob || '';
    initPrivacySelectors();
  }

  function updateProfileDisplay() {
    coverPhoto.src = userProfile.coverPhoto || 'https://via.placeholder.com/1000x250';
    profilePicture.src = userProfile.profilePicture || 'https://via.placeholder.com/120';
  }

  function initImageUploads() {
    profilePicture.addEventListener('click', () => {
      currentUploadType = 'profile';
      document.getElementById('imageUploadTitle').textContent = 'Upload Profile Picture';
      imageUploadModal.style.display = 'flex';
      imagePreview.innerHTML = '';
      imageUploadInput.value = '';
    });

    coverPhoto.addEventListener('click', () => {
      currentUploadType = 'cover';
      document.getElementById('imageUploadTitle').textContent = 'Upload Cover Photo';
      imageUploadModal.style.display = 'flex';
      imagePreview.innerHTML = '';
      imageUploadInput.value = '';
    });

    imageUploadArea.addEventListener('click', () => imageUploadInput.click());

    imageUploadInput.addEventListener('change', (e) => {
      if (e.target.files.length > 0) {
        const file = e.target.files[0];
        if (!file.type.startsWith('image/')) return showMessage('Select an image file.');
        if (file.size > MAX_FILE_SIZE) return showMessage('Max file 10MB.');

        const reader = new FileReader();
        reader.onload = function(e) {
          imagePreview.innerHTML = `<img src="${e.target.result}">`;
        };
        reader.readAsDataURL(file);
      }
    });

    uploadImageBtn.addEventListener('click', () => {
      const file = imageUploadInput.files[0];
      if (!file) return showMessage('Select an image.');
      // Simulate upload
      setTimeout(() => {
        const url = URL.createObjectURL(file);
        if(currentUploadType === 'cover') userProfile.coverPhoto = url;
        if(currentUploadType === 'profile') userProfile.profilePicture = url;
        updateProfileDisplay();
        imageUploadModal.style.display = 'none';
        showMessage('Image uploaded!', 'success');
      }, 1000);
    });
  }

  function initModals() {
    editProfileBtn.addEventListener('click', () => {
      editProfileModal.style.display = 'flex';
      populateEditForm();
    });
    closeEditModal.addEventListener('click', () => editProfileModal.style.display = 'none');
    closeImageModal.addEventListener('click', () => imageUploadModal.style.display = 'none');
    closeImageViewModal.addEventListener('click', () => imageViewModal.style.display = 'none');

    window.addEventListener('click', (e) => {
      if (e.target === editProfileModal) editProfileModal.style.display = 'none';
      if (e.target === imageUploadModal) imageUploadModal.style.display = 'none';
      if (e.target === imageViewModal) imageViewModal.style.display = 'none';
    });
  }

  profileForm.addEventListener('submit', (e) => {
    e.preventDefault();
    userProfile.fullName = document.getElementById('fullName').value;
    userProfile.bio = document.getElementById('bio').value;
    userProfile.dob = document.getElementById('dob').value;
    updateProfileDisplay();
    editProfileModal.style.display = 'none';
    showMessage('Profile updated!', 'success');
  });

  nightToggleBtn.addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
  });

  function loadUserPosts() {
    postsGrid.innerHTML = '';
    const posts = [
      { text: 'Hello world!', media: '', privacy:'public', likes: 5, comments: [] },
      { text: '', media: 'https://via.placeholder.com/150', privacy:'private', likes: 3, comments: [{},{}] }
    ];
    posts.forEach(post => {
      const postElement = document.createElement('div');
      postElement.className = 'post-thumbnail';
      if(post.privacy==='private') postElement.classList.add('private');
      if(post.media){
        postElement.innerHTML = `<img src="${post.media}">` + (post.privacy==='private'?'<div class="private-badge"><i class="fas fa-lock"></i></div>':'');
      } else {
        postElement.innerHTML = `<div style="padding:20px;">${post.text}</div>` + (post.privacy==='private'?'<div class="private-badge"><i class="fas fa-lock"></i></div>':'');
      }
      postsGrid.appendChild(postElement);
    });
  }

  // --- Init ---
  document.addEventListener('DOMContentLoaded', function() {
    updateProfileDisplay();
    initPrivacySelectors();
    initImageUploads();
    initModals();
    loadUserPosts();
  });
</script>

</body>
</html>
