<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>MEET | Meetversity</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  /* --- BASE STYLES FROM MEETRADER TEMPLATE --- */
  :root {
    --primary: #0080FF;
    --primary-dark: #0066CC;
    --error: #EF4444;
    --success: #10B981;
    --warning: #F59E0B;
    --bg-color: #f0f2f5;
    --card-bg: #fff;
    --text-color: #111;
    --secondary-text: #65676b;
    --border-color: #dddfe2;
    --online: #10B981;
    --offline: #EF4444;
    /* Meetversity specific */
    --edu-primary: #0061FF;
    --edu-accent: #5AE4A8;
    --edu-gradient: linear-gradient(135deg, var(--edu-primary) 0%, var(--edu-accent) 100%);
    --radius: 12px;
    --shadow: 0 4px 12px rgba(0,0,0,0.05);
  }

  body.dark-mode {
    --bg-color: #18191a;
    --card-bg: #242526;
    --text-color: #e4e6eb;
    --secondary-text: #b0b3b8;
    --border-color: #3e4042;
    --shadow: 0 4px 12px rgba(0,0,0,0.3);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  html, body { height: 100%; overflow-x: hidden; font-size: 18px; }
  body { font-family: 'Poppins', sans-serif; background: var(--bg-color); color: var(--text-color); transition: all 0.3s ease; min-height: 100vh; }
  
  .app-container { display: flex; min-height: 100vh; position: relative; }

  /* Sidebar and Navbar styles are imported from Meetrader template */
  .sidebar {
    position: fixed; left: 0; top: 0; height: 100vh; width: 180px;
    background: linear-gradient(180deg, #0080FF 0%, #00C6FF 100%);
    border-right: 1px solid var(--border-color); overflow-y: auto; z-index: 100; padding: 15px; color: white;
  }
  .sidebar-header { padding: 5px 0 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.2); margin-bottom: 15px; }
  .sidebar-menu { list-style: none; }
  .sidebar-menu li { margin-bottom: 6px; }
  .sidebar-menu a {
    display: flex; align-items: center; padding: 10px; text-decoration: none; color: white;
    border-radius: 8px; transition: background 0.3s; min-height: 40px; font-size: 16px;
  }
  .sidebar-menu a:hover { background: rgba(255, 255, 255, 0.2); }
  .sidebar-menu i { margin-right: 10px; font-size: 18px; width: 22px; text-align: center; }

  /* Active style for Meetversity */
  .sidebar-menu a[href="meetversity.html"] { 
    background: rgba(255, 255, 255, 0.3); 
    box-shadow: 0 0 10px rgba(0,0,0,0.2);
  }

  /* Icons Colors */
  .sidebar-menu a[href="feed.html"] i { color: #fff; }
  .sidebar-menu a[onclick*="viewProfile"] i { color: #f4d03f; }
  .sidebar-menu a[href="chat.html"] i { color: #4CAF50; }
  .sidebar-menu a[href="meetrader.html"] i { color: #FF5722; }
  .sidebar-menu a[href="meetversity.html"] i { color: #9C27B0; }
  .sidebar-menu a[href="organization.html"] i { color: #00BCD4; }
  .sidebar-menu a[onclick*="openUsersModal"] i { color: #e91e63; }

  .main-content { flex: 1; margin-left: 180px; padding: 15px; min-height: 100vh; font-size: 18px; }

  .navbar {
    background: linear-gradient(135deg, #0080FF 0%, #00C6FF 100%);
    padding: 10px 15px; border-radius: 10px; margin-bottom: 15px;
    display: flex; justify-content: space-between; align-items: center;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1); color: white; flex-wrap: wrap; gap: 8px;
  }
  .search-bar { display: flex; align-items: center; background: rgba(255, 255, 255, 0.2); border-radius: 20px; padding: 6px 12px; margin-right: 10px; }
  .search-bar input { background: transparent; border: none; color: white; outline: none; width: 180px; font-size: 16px; }
  .user-profile-nav { display: flex; align-items: center; gap: 8px; padding: 4px 8px; border-radius: 20px; background: rgba(255, 255, 255, 0.2); cursor: pointer; position: relative; min-height: 36px; }
  .user-avatar { width: 36px; height: 36px; border-radius: 50%; background: var(--primary); color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer; position: relative; min-width: 36px; font-size: 16px; overflow: hidden; }
  .user-avatar.small { width: 28px; height: 28px; font-size: 14px; min-width: 28px; }
  .user-avatar img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
  .btn {
    background: rgba(255, 255, 255, 0.2); color: white; border: none;
    padding: 6px 12px; border-radius: 6px; cursor: pointer; font-weight: 600;
    transition: background 0.3s; display: flex; align-items: center; gap: 6px;
    font-size: 16px; min-height: 36px;
  }
  .nav-controls { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
  .unread-badge { background: var(--error); color: white; border-radius: 50%; padding: 2px 5px; font-size: 10px; display: none; min-width: 16px; justify-content: center; align-items: center; }

  /* --- MEETVERSITY STYLES (MODIFIED TO FIT TEMPLATE) --- */
  .meetversity-container { max-width: 1200px; margin: 0 auto; width: 100%; }
  
  .meetversity-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
  .meetversity-title {
    font-size: 32px;
    font-weight: 700;
    background: var(--edu-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin: 0;
  }
  .create-btn {
    background: var(--edu-primary); /* Use primary blue for main action */
    color: white;
    border: 0;
    padding: 10px 15px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: background 0.2s;
  }
  .create-btn:hover { background: var(--edu-primary); opacity: 0.9; }

  /* Stats */
  .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px; }
  .stat-card {
    background: var(--card-bg);
    border-radius: var(--radius);
    padding: 15px;
    text-align: center;
    box-shadow: var(--shadow);
  }
  .stat-value {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 5px;
    color: var(--edu-primary); /* Use edu primary for stats */
  }
  .stat-label { font-size: 14px; color: var(--secondary-text); }

  /* Content Types */
  .content-types { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
  .content-type-card {
    background: var(--card-bg);
    border-radius: var(--radius);
    padding: 20px;
    text-align: center;
    box-shadow: var(--shadow);
    transition: transform 0.3s;
    cursor: pointer;
    border: 2px solid transparent;
  }
  .content-type-card:hover { transform: translateY(-3px); border-color: var(--edu-primary); }
  .content-icon { font-size: 36px; margin-bottom: 10px; display: block; }
  .content-title { font-size: 16px; font-weight: 700; margin-bottom: 5px; }
  .content-description { font-size: 13px; color: var(--secondary-text); line-height: 1.4; }

  /* Sections */
  .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
  .section-title { font-size: 22px; font-weight: 700; margin: 0; }
  .view-all { color: var(--primary); font-weight: 600; text-decoration: none; font-size: 14px; }

  /* Courses & Learning Paths (similar styling) */
  .courses-grid, .learning-paths {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
  }
  .course-card, .path-card {
    background: var(--card-bg);
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
    transition: transform 0.3s;
    position: relative;
    cursor: pointer; /* Added cursor pointer */
  }
  .course-card:hover, .path-card:hover { transform: translateY(-5px); }
  .course-thumbnail { width: 100%; height: 150px; object-fit: cover; }
  .course-details { padding: 15px; }
  .course-category { font-size: 12px; color: var(--edu-primary); font-weight: 600; margin-bottom: 5px; text-transform: uppercase; }
  .course-title { font-size: 16px; font-weight: 700; margin-bottom: 8px; line-height: 1.3; }
  .course-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 13px; color: var(--secondary-text); }
  .course-instructor { display: flex; align-items: center; gap: 8px; }
  .instructor-avatar { width: 24px; height: 24px; border-radius: 50%; object-fit: cover; }
  .course-duration, .path-meta span { display: flex; align-items: center; gap: 4px; }
  .course-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
  .course-price { font-weight: 700; color: var(--edu-primary); }
  .certificate-badge { background: rgba(90,228,168,0.1); color: var(--success); font-size: 11px; padding: 3px 8px; border-radius: 20px; font-weight: 600; }
  
  .path-card { padding: 20px; }
  .path-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: var(--edu-gradient); }
  .path-icon { font-size: 24px; margin-bottom: 10px; color: var(--edu-primary); }
  .path-title { font-size: 16px; font-weight: 700; margin-bottom: 8px; }
  .path-description { font-size: 13px; color: var(--secondary-text); margin-bottom: 12px; line-height: 1.4; }
  .path-meta { display: flex; justify-content: space-between; align-items: center; font-size: 13px; color: var(--secondary-text); }


  /* Quick Videos */
  .quick-videos { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; margin-bottom: 40px; }
  .quick-video-card {
    background: var(--card-bg);
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
    transition: transform 0.3s;
    cursor: pointer; /* Added cursor pointer */
  }
  .quick-video-card:hover { transform: scale(1.03); }
  .quick-video-thumbnail { width: 100%; height: 100px; object-fit: cover; }
  .quick-video-details { padding: 10px; }
  .quick-video-title { font-size: 13px; font-weight: 600; margin-bottom: 5px; line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
  .quick-video-meta { display: flex; justify-content: space-between; align-items: center; font-size: 11px; color: var(--secondary-text); }
  
  /* Documents */
  .documents-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 15px; }
  .document-card {
    background: var(--card-bg);
    border-radius: var(--radius);
    padding: 15px;
    box-shadow: var(--shadow);
    transition: transform 0.3s;
    display: flex;
    align-items: center;
    gap: 15px;
    cursor: pointer; /* Added cursor pointer */
  }
  .document-card:hover { transform: translateY(-3px); }
  .document-icon {
    width: 40px;
    height: 40px;
    background: rgba(0,97,255,0.1);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    color: var(--edu-primary);
    flex-shrink: 0;
  }
  .document-details { flex: 1; }
  .document-title { font-size: 14px; font-weight: 600; margin-bottom: 4px; }
  .document-meta { display: flex; gap: 8px; font-size: 11px; color: var(--secondary-text); }

  /* Modal Overrides for consistency */
  .modal-content { max-width: 800px; }
  .modal-header h3 { font-size: 20px; }
  
  /* Create Content Modal Form Styles (Using Meetrader form styles) */
  .form-group { margin-bottom: 15px; }
  .form-label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 14px; }
  .form-input, .form-select, .form-textarea {
    width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);
    background: var(--bg-color); color: var(--text-color); outline: none; font-size: 15px;
  }
  .form-textarea { resize: vertical; min-height: 80px; }
  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }

  .content-type-tabs { display: flex; gap: 10px; margin-bottom: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
  .content-type-tab {
    background: transparent; border: 0; padding: 8px 15px; border-radius: 6px; font-weight: 600; cursor: pointer;
    color: var(--secondary-text); transition: all 0.2s; font-size: 14px;
  }
  .content-type-tab.active { background: rgba(0,97,255,0.1); color: var(--edu-primary); }

  .file-upload {
    border: 2px dashed var(--border-color); border-radius: 8px; padding: 20px; text-align: center; cursor: pointer; transition: border 0.2s;
    margin-top: 10px;
  }
  .file-upload:hover { border-color: var(--edu-primary); }
  .file-upload-icon { font-size: 30px; margin-bottom: 5px; color: var(--secondary-text); }
  .file-upload-text { font-size: 13px; color: var(--secondary-text); }
  .file-preview { display: none; margin-top: 10px; border-radius: 8px; overflow: hidden; }
  .file-preview img, .file-preview video { width: 100%; max-height: 150px; object-fit: cover; }
  .modal-footer { display: flex; justify-content: flex-end; gap: 10px; padding: 15px; border-top: 1px solid var(--border-color); }
  .cancel-btn {
    background: var(--bg-color); border: 1px solid var(--border-color); padding: 8px 15px; border-radius: 6px; font-weight: 600; cursor: pointer;
  }
  .submit-btn {
    background: var(--edu-primary); color: white; border: 0; padding: 8px 15px; border-radius: 6px; font-weight: 600; cursor: pointer;
  }
  
  /* Responsive Overrides (Matching Meetrader structure) */
  @media (max-width: 768px) {
    .sidebar { width: 60px; padding: 8px 4px; }
    .sidebar-header { display: none; }
    .sidebar-menu a { flex-direction: column; padding: 8px 4px; font-size: 12px; text-align: center; }
    .sidebar-menu i { margin-right: 0; margin-bottom: 4px; font-size: 18px; }
    .main-content { margin-left: 60px; padding: 8px; width: calc(100% - 60px); }
    .navbar { flex-direction: column; align-items: flex-start; gap: 10px; }
    .search-bar, .user-profile-nav span, .btn span { display: none; }
    .nav-controls { width: 100%; justify-content: space-between; }
    .stats-grid { grid-template-columns: repeat(2, 1fr); }
    .content-types { grid-template-columns: 1fr; }
    .courses-grid, .learning-paths { grid-template-columns: 1fr; }
    .quick-videos { grid-template-columns: repeat(2, 1fr); }
    .documents-grid { grid-template-columns: 1fr; }
    .form-row { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<div class="app-container">
  <div class="sidebar">
    <div class="sidebar-header">
      <h2 style="color: white; font-size: 20px;">MEET</h2>
    </div>
    <ul class="sidebar-menu">
      <li><a href="feed.html"><i class="fas fa-home"></i> <span>Feed</span></a></li>
      <li><a href="#" onclick="viewProfile(auth.currentUser.uid)"><i class="fas fa-user"></i> <span>Profile</span></a></li>
      <li><a href="chat.html"><i class="fas fa-comment"></i> <span>Chat</span></a></li>
      <li><a href="meetrader.html"><i class="fas fa-chart-line"></i> <span>Meetrader</span></a></li>
      <li><a href="meetversity.html"><i class="fas fa-graduation-cap"></i> <span>Meetversity</span></a></li>
      <li><a href="organization.html"><i class="fas fa-sitemap"></i> <span>Organization</span></a></li>
      <li><a href="#" onclick="openUsersModal()"><i class="fas fa-users"></i> <span>Find Associates</span></a></li>
    </ul>
  </div>

  <div class="main-content">
    <div class="navbar">
      <h2 style="color: white; font-size: 20px;">Meetversity</h2>
      <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 8px;">
        <div class="search-bar">
          <i class="fas fa-search"></i>
          <input type="text" placeholder="Search courses, videos, documents...">
        </div>
        <div class="nav-controls">
          <div class="user-profile-nav" onclick="viewProfile(auth.currentUser.uid)">
            <div class="user-avatar small" id="currentUserAvatar">U</div>
            <span id="userName" style="font-size: 15px;">User</span>
          </div>
          <button class="btn" id="notificationsBtn" onclick="openNotificationsModal()">
            <i class="fas fa-bell"></i> <span style="font-size: 15px;">Notifications</span>
            <span class="unread-badge" id="unreadBadge"></span>
          </button>
          <button class="btn" id="nightToggleBtn">
            <i class="fas fa-moon"></i> <span style="font-size: 15px;">Night Mode</span>
          </button>
          <button class="btn" id="logoutBtn">
            <i class="fas fa-sign-out-alt"></i> <span style="font-size: 15px;">Logout</span>
          </button>
        </div>
      </div>
    </div>
    
    <div class="meetversity-container">
      
      <div class="meetversity-header">
        <h1 class="meetversity-title">MEETVERSITY</h1>
        <div class="meetversity-actions">
          <button class="create-btn" id="createContentBtn">
            <i class="fas fa-plus"></i> Create Content
          </button>
        </div>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value">1,247</div>
          <div class="stat-label">Courses</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">5,892</div>
          <div class="stat-label">Quick Videos</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">3,145</div>
          <div class="stat-label">Documents</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">28,451</div>
          <div class="stat-label">Learners</div>
        </div>
      </div>
      
      <hr style="border:0; border-top:1px solid var(--border-color); margin: 20px 0;">

      <div class="section-header">
        <h2 class="section-title">New Content</h2>
      </div>
      <div class="content-types">
        <div class="content-type-card" data-type="long-video">
          <span class="content-icon" style="color:#0061FF;"><i class="fas fa-video"></i></span>
          <h3 class="content-title">Long Video Course</h3>
          <p class="content-description">In-depth courses with multiple lessons and assessments. (Hours)</p>
        </div>
        <div class="content-type-card" data-type="quick-video">
          <span class="content-icon" style="color:#5AE4A8;"><i class="fas fa-bolt"></i></span>
          <h3 class="content-title">Quick Video</h3>
          <p class="content-description">Short educational videos (1-2 minutes) for quick skill acquisition.</p>
        </div>
        <div class="content-type-card" data-type="document">
          <span class="content-icon" style="color:#9C27B0;"><i class="fas fa-file-alt"></i></span>
          <h3 class="content-title">Study Document</h3>
          <p class="content-description">Upload PDFs, presentations, or study guides for reading.</p>
        </div>
      </div>
      
      <hr style="border:0; border-top:1px solid var(--border-color); margin: 20px 0;">

      <div class="section-header">
        <h2 class="section-title">Learning Paths (Static Mock)</h2>
        <a href="#" class="view-all">View All</a>
      </div>
      <div class="learning-paths">
        <div class="path-card">
          <div class="path-icon"><i class="fas fa-code"></i></div>
          <h3 class="path-title">Web Development</h3>
          <p class="path-description">Master HTML, CSS, JavaScript and modern frameworks to build responsive websites.</p>
          <div class="path-meta">
            <span><i class="fas fa-book-open"></i> 12 Courses</span>
            <span><i class="fas fa-clock"></i> 45h 20m</span>
          </div>
        </div>
        <div class="path-card">
          <div class="path-icon"><i class="fas fa-palette"></i></div>
          <h3 class="path-title">UI/UX Design</h3>
          <p class="path-description">Learn user-centered design principles, prototyping, and design tools.</p>
          <div class="path-meta">
            <span><i class="fas fa-book-open"></i> 8 Courses</span>
            <span><i class="fas fa-clock"></i> 32h 15m</span>
          </div>
        </div>
        <div class="path-card">
          <div class="path-icon"><i class="fas fa-mobile-alt"></i></div>
          <h3 class="path-title">Mobile Development</h3>
          <p class="path-description">Build native and cross-platform mobile applications for iOS and Android.</p>
          <div class="path-meta">
            <span><i class="fas fa-book-open"></i> 10 Courses</span>
            <span><i class="fas fa-clock"></i> 38h 40m</span>
          </div>
        </div>
      </div>

      <div class="section-header">
        <h2 class="section-title">Featured Courses</h2>
        <a href="#" class="view-all">View All</a>
      </div>
      <div class="courses-grid" id="coursesGrid">
        <p style="text-align: center; color: var(--secondary-text);">Loading courses...</p>
      </div>
      
      <hr style="border:0; border-top:1px solid var(--border-color); margin: 20px 0;">

      <div class="section-header">
        <h2 class="section-title">Quick Videos</h2>
        <a href="#" class="view-all">View All</a>
      </div>
      <div class="quick-videos" id="quickVideosGrid">
        <p style="text-align: center; color: var(--secondary-text);">Loading quick videos...</p>
      </div>

      <hr style="border:0; border-top:1px solid var(--border-color); margin: 20px 0;">

      <div class="section-header">
        <h2 class="section-title">Study Documents</h2>
        <a href="#" class="view-all">View All</a>
      </div>
      <div class="documents-grid" id="documentsGrid">
        <p style="text-align: center; color: var(--secondary-text);">Loading documents...</p>
      </div>
    </div>
    </div>
</div>

<div class="modal" id="createContentModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Create Educational Content</h3>
      <button class="close-modal" id="closeCreateModal">&times;</button>
    </div>
    
    <div class="modal-body">
      <div class="content-type-tabs">
        <button class="content-type-tab active" data-type="long-video">Long Video Course</button>
        <button class="content-type-tab" data-type="quick-video">Quick Video</button>
        <button class="content-type-tab" data-type="document">Document</button>
      </div>
      
      <form id="createContentForm">
        <div class="form-group">
          <label class="form-label" for="contentTitle">Name of the Course/Content</label>
          <input type="text" class="form-input" id="contentTitle" placeholder="e.g., Advanced JavaScript Patterns" required>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="targetAudience">Target Audience</label>
          <input type="text" class="form-input" id="targetAudience" placeholder="e.g., Beginner Developers, Junior Designers" required>
        </div>

        <div class="form-group">
          <label class="form-label" for="learningOutcomes">Key Learning Outcomes</label>
          <textarea class="form-textarea" id="learningOutcomes" placeholder="List 3-5 things the learner will be able to do after finishing the content..."></textarea>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="contentCategory">Course Categories</label>
          <select class="form-select" id="contentCategory" required>
            <option value="">Select a category</option>
            <option value="technology">Technology</option>
            <option value="design">Design</option>
            <option value="business">Business</option>
            <option value="marketing">Marketing</option>
            <option value="languages">Languages</option>
            <option value="science">Science</option>
            <option value="arts">Arts & Creativity</option>
            <option value="personal-development">Personal Development</option>
          </select>
        </div>
        
        <div class="form-group">
          <label class="form-label">Course Type</label>
          <div class="radio-group" style="flex-direction:row; gap:15px; background:transparent; padding:0; border:none;">
            <label class="radio-item">
              <input type="radio" name="courseType" value="one-time" checked>
              One-time Course
            </label>
            <label class="radio-item">
              <input type="radio" name="courseType" value="long-term">
              Long-term Course
            </label>
          </div>
        </div>
        
        <div class="form-group" id="courseOutlineGroup">
          <label class="form-label" for="courseOutline">Course Outline</label>
          <textarea class="form-textarea" id="courseOutline" placeholder="Describe the course structure, modules, and learning objectives..."></textarea>
          <div class="file-upload" id="outlineUpload">
            <div class="file-upload-icon"><i class="fas fa-file-pdf"></i></div>
            <div class="file-upload-text">Or upload course outline as PDF</div>
            <input type="file" id="outlineFile" accept=".pdf" style="display: none">
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="contentDuration">Duration to Complete</label>
          <input type="text" class="form-input" id="contentDuration" placeholder="e.g., 4 weeks, 12 hours" required>
        </div>
        
        <div class="form-group" id="mediaUploadGroup">
          <label class="form-label">Upload Content</label>
          <div class="file-upload" id="mediaUpload">
            <div class="file-upload-icon" id="mediaIcon"><i class="fas fa-video"></i></div>
            <div class="file-upload-text" id="mediaText">Click to upload your video file</div>
            <input type="file" id="mediaFile" style="display: none">
          </div>
          <div class="file-preview" id="mediaPreview">
            <video id="previewVideo" controls></video>
          </div>
        </div>
        
        <div class="form-group">
          <div class="radio-item">
            <input type="checkbox" id="offerCertificate" style="accent-color:var(--edu-primary);">
            <label for="offerCertificate" style="font-weight:400; font-size:15px; margin-left:-5px;">Offer MEET Certificate to learners upon completion</label>
          </div>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="cancel-btn" id="cancelCreate">Cancel</button>
      <button type="button" class="submit-btn" id="submitContent">Create Content</button>
    </div>
  </div>
</div>

<div class="modal" id="notificationsModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 style="font-size: 18px;">Notifications</h3>
      <button class="close-modal" id="closeNotificationsModal">&times;</button>
    </div>
    <div class="modal-body">
      <div id="notificationsList"></div>
    </div>
  </div>
</div>

<div class="modal" id="usersModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 style="font-size: 18px;">Find Associates</h3>
      <button class="close-modal" id="closeUsersModal">&times;</button>
    </div>
    <div class="modal-body">
      <div id="usersList"><div class="loading">Loading users...</div></div>
    </div>
  </div>
</div>

<script type="module">
    // Firebase imports and configuration (unchanged)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
    import { 
        getFirestore, collection, addDoc, deleteDoc, doc, getDoc, getDocs, 
        onSnapshot, query, where, orderBy, updateDoc, setDoc, arrayUnion, arrayRemove, serverTimestamp 
    } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
    
    // Cloudinary import (simplified placeholder as actual upload logic is complex)
    // import * as cloudinary from "cloudinary-core"; 

    const firebaseConfig = {
        apiKey: "AIzaSyDtqM_pMGIYkUgy0OWGsQbfS9MtYQhrgZM",
        authDomain: "meet-6e159.firebaseapp.com",
        databaseURL: "https://meet-6e159-default-rtdb.firebaseio.com",
        projectId: "meet-6e159",
        storageBucket: "meet-6e159-firebasestorage.app",
        messagingSenderId: "252353608421",
        appId: "1:252353608421:web:6706056048e9a8f12db20c"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);
    // Cloudinary configuration placeholder (real logic would involve storage or API calls)
    const cloudinaryConfig = { cloudName: 'YOUR_CLOUD_NAME' }; // Placeholder

    let currentUser = null;

    // --- HELPER FUNCTIONS ---
    function getAvatarHTML(photoURL, name, size = 'medium') {
        const initial = name ? name.charAt(0).toUpperCase() : 'U';
        const style = size === 'small' ? 'width:28px;height:28px;font-size:14px; min-width: 28px;' : 'width:36px;height:36px;font-size:16px; min-width: 36px;';
        if (photoURL) return `<img src="${photoURL}" alt="${name}" style="${style} border-radius:50%; object-fit:cover;">`;
        return `<div style="${style} background:var(--primary); color:white; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold;">${initial}</div>`;
    }

    // New navigation function for content
    window.viewContent = (id) => { 
        console.log('Viewing content with ID:', id);
        // window.location.href = `content.html?id=${id}`; // Real navigation
    };

    window.viewProfile = (targetId) => { if(targetId) window.location.href = `profile.html?uid=${targetId}`; };
    window.openUsersModal = async () => { /* Logic from Meetrader */ };
    window.toggleAssociate = async (targetId, isCurrentlyAssociated) => { /* Logic from Meetrader */ };
    window.openNotificationsModal = () => { /* Logic from Meetrader */ };
    window.markNotifRead = async (id) => await updateDoc(doc(db, "notifications", id), { read: true });
    window.deleteNotif = async (id) => await deleteDoc(doc(db, "notifications", id));
    
    // Basic controls
    document.getElementById('closeNotificationsModal').onclick = () => document.getElementById('notificationsModal').style.display = 'none';
    document.getElementById('closeUsersModal').onclick = () => document.getElementById('usersModal').style.display = 'none';
    document.getElementById('nightToggleBtn').onclick = () => document.body.classList.toggle('dark-mode');
    document.getElementById('logoutBtn').onclick = () => signOut(auth);

    // --- AUTH & INIT ---
    onAuthStateChanged(auth, async (user) => {
        if (user) {
            currentUser = user;
            const userDoc = await getDoc(doc(db, "users", user.uid));
            const userData = userDoc.exists() ? userDoc.data() : {};
            
            currentUser.displayName = userData.displayName || user.displayName;
            currentUser.photoURL = userData.photoURL || user.photoURL;

            document.getElementById('currentUserAvatar').innerHTML = getAvatarHTML(currentUser.photoURL, currentUser.displayName || 'User', 'small');
            document.getElementById('userName').textContent = currentUser.displayName || 'User';
            
            setupNotificationsCount();
            initMeetversity(); // Initialize Meetversity content
        } else {
            // window.location.href = 'login.html'; // Uncomment in production
        }
    });

    // --- MEETVERSITY LOGIC: REAL DATA FETCHING ---

    let currentContentType = 'long-video';
    
    // DOM Elements
    const createContentModal = document.getElementById('createContentModal');
    const closeCreateModal = document.getElementById('closeCreateModal');
    const cancelCreate = document.getElementById('cancelCreate');
    const createContentBtn = document.getElementById('createContentBtn');
    const contentTypeTabs = document.querySelectorAll('.content-type-tab');
    const contentTypeCards = document.querySelectorAll('.content-type-card');
    const coursesGrid = document.getElementById('coursesGrid');
    const quickVideosGrid = document.getElementById('quickVideosGrid');
    const documentsGrid = document.getElementById('documentsGrid');
    const createContentForm = document.getElementById('createContentForm');
    const submitContent = document.getElementById('submitContent');
    const mediaUpload = document.getElementById('mediaUpload');
    const mediaFile = document.getElementById('mediaFile');
    const mediaPreview = document.getElementById('mediaPreview');
    const previewVideo = document.getElementById('previewVideo');
    const outlineUpload = document.getElementById('outlineUpload');
    const outlineFile = document.getElementById('outlineFile');
    const mediaIcon = document.getElementById('mediaIcon');
    const mediaText = document.getElementById('mediaText');
    const courseOutlineGroup = document.getElementById('courseOutlineGroup');
    const mediaUploadGroup = document.getElementById('mediaUploadGroup');
    
    // New/Updated fields
    const contentTitle = document.getElementById('contentTitle');
    const targetAudience = document.getElementById('targetAudience');
    const learningOutcomes = document.getElementById('learningOutcomes');
    const contentCategory = document.getElementById('contentCategory');
    const contentDuration = document.getElementById('contentDuration');


    function initMeetversity() {
      // Setup real-time listeners for each content type
      setupCoursesListener();
      setupQuickVideosListener();
      setupDocumentsListener();
      setupMeetversityEventListeners();
    }
    
    // --- REAL-TIME CONTENT FETCHING ---

    async function getUserDetails(uid) {
        const docRef = doc(db, "users", uid);
        const docSnap = await getDoc(docRef);
        return docSnap.exists() ? docSnap.data() : { displayName: 'Unknown Creator', photoURL: null };
    }
    
    async function renderCourses(courses) {
        let html = '';
        for (const course of courses) {
            // Fetch creator's details for real data
            const creator = await getUserDetails(course.creatorId);
            html += `
                <div class="course-card" onclick="viewContent('${course.id}')">
                    <img src="${course.thumbnailUrl || 'https://images.unsplash.com/photo-1541701494587-c5b141459c3a?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'}" alt="${course.title}" class="course-thumbnail">
                    <div class="course-details">
                        <div class="course-category">${course.category}</div>
                        <h3 class="course-title">${course.title}</h3>
                        <div class="course-meta">
                            <div class="course-instructor">
                                ${getAvatarHTML(creator.photoURL, creator.displayName, 'small')}
                                <span class="instructor-name">${creator.displayName}</span>
                            </div>
                            <div class="course-duration">
                                <i class="fas fa-clock"></i> ${course.duration}
                            </div>
                        </div>
                        <div class="course-footer">
                            <div class="course-price">${course.price || 'Free'}</div>
                            ${course.offerCertificate ? '<div class="certificate-badge">Certificate</div>' : ''}
                        </div>
                    </div>
                </div>
            `;
        }
        coursesGrid.innerHTML = html || '<p style="padding: 15px; color: var(--secondary-text);">No courses found.</p>';
    }

    function setupCoursesListener() {
        // Query courses (long-video content)
        const q = query(collection(db, "meetversity"), where("contentType", "==", "long-video"), orderBy("createdAt", "desc"));
        onSnapshot(q, (snapshot) => {
            const courses = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            renderCourses(courses);
        }, (error) => {
            console.error("Error fetching courses:", error);
            coursesGrid.innerHTML = '<p style="padding: 15px; color: var(--error);">Error loading courses. Please check console.</p>';
        });
    }

    function renderQuickVideos(videos) {
        quickVideosGrid.innerHTML = videos.map(video => `
            <div class="quick-video-card" onclick="viewContent('${video.id}')">
                <img src="${video.thumbnailUrl || 'https://images.unsplash.com/photo-1510511459019-5beef44a1b5e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'}" alt="${video.title}" class="quick-video-thumbnail">
                <div class="quick-video-details">
                    <h3 class="quick-video-title">${video.title}</h3>
                    <div class="quick-video-meta">
                        <span><i class="fas fa-clock"></i> ${video.duration}</span>
                        <span><i class="fas fa-eye"></i> ${video.views || '0'}</span>
                    </div>
                </div>
            </div>
        `).join('') || '<p style="grid-column: 1 / -1; padding: 15px; color: var(--secondary-text);">No quick videos found.</p>';
    }

    function setupQuickVideosListener() {
        // Query quick videos
        const q = query(collection(db, "meetversity"), where("contentType", "==", "quick-video"), orderBy("createdAt", "desc"));
        onSnapshot(q, (snapshot) => {
            const videos = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            renderQuickVideos(videos);
        });
    }

    function renderDocuments(documents) {
        documentsGrid.innerHTML = documents.map(doc => `
            <div class="document-card" onclick="viewContent('${doc.id}')">
                <div class="document-icon"><i class="fas fa-file-pdf"></i></div>
                <div class="document-details">
                    <h3 class="document-title">${doc.title}</h3>
                    <div class="document-meta">
                        <span>${doc.fileType || 'Document'}</span>
                        <span>${doc.pages || 'N/A'} pages</span>
                        <span><i class="fas fa-download"></i> ${doc.downloads || '0'}</span>
                    </div>
                </div>
            </div>
        `).join('') || '<p style="grid-column: 1 / -1; padding: 15px; color: var(--secondary-text);">No documents found.</p>';
    }
    
    function setupDocumentsListener() {
        // Query study documents
        const q = query(collection(db, "meetversity"), where("contentType", "==", "document"), orderBy("createdAt", "desc"));
        onSnapshot(q, (snapshot) => {
            const documents = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            renderDocuments(documents);
        });
    }


    // Modal Handlers
    function closeCreateModalHandler() {
      createContentModal.style.display = 'none';
      createContentForm.reset();
      mediaPreview.style.display = 'none';
      // Reset media text and icon
      mediaIcon.innerHTML = `<i class="fas fa-video"></i>`;
      mediaText.textContent = 'Click to upload your video file';
    }

    function setContentType(type) {
      currentContentType = type;
      
      // Update form based on content type
      if (type === 'long-video') {
        mediaIcon.innerHTML = `<i class="fas fa-video"></i>`;
        mediaText.textContent = 'Click to upload your video file';
        mediaFile.accept = 'video/*';
        courseOutlineGroup.style.display = 'block';
        contentTitle.placeholder = 'e.g., Advanced JavaScript Patterns';
      } else if (type === 'quick-video') {
        mediaIcon.innerHTML = `<i class="fas fa-bolt"></i>`;
        mediaText.textContent = 'Click to upload your quick video (1-2 min)';
        mediaFile.accept = 'video/*';
        courseOutlineGroup.style.display = 'none';
        contentTitle.placeholder = 'e.g., CSS Flexbox in 90 seconds';
      } else if (type === 'document') {
        mediaIcon.innerHTML = `<i class="fas fa-file-alt"></i>`;
        mediaText.textContent = 'Click to upload your document (PDF, PPT, etc.)';
        mediaFile.accept = '.pdf,.ppt,.pptx,.doc,.docx';
        courseOutlineGroup.style.display = 'none';
        contentTitle.placeholder = 'e.g., React Hooks Cheatsheet';
      }
    }

    // Simplified media upload handler (real scenario needs Firebase Storage/Cloudinary upload)
    function handleMediaUpload(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      mediaPreview.style.display = 'none';
      previewVideo.style.display = 'none';
      
      if (file.type.startsWith('video/')) {
        const reader = new FileReader();
        reader.onload = function(e) {
          previewVideo.src = e.target.result;
          previewVideo.style.display = 'block';
          mediaPreview.style.display = 'block';
          mediaText.textContent = file.name;
        };
        reader.readAsDataURL(file);
      } else {
        mediaPreview.innerHTML = `<div style="padding: 10px; text-align: center; color: var(--secondary-text); font-size:14px;">File uploaded: ${file.name}</div>`;
        mediaPreview.style.display = 'block';
        mediaText.textContent = file.name;
      }
    }

    // --- SUBMIT CONTENT HANDLER (UPDATED TO INCLUDE NEW FIELDS) ---
    async function submitContentHandler() {
        if (!currentUser) {
            alert('Please log in to create content.');
            return;
        }

        // Get values from the form
        const title = contentTitle.value;
        const category = contentCategory.value;
        const target = targetAudience.value; // New Field
        const outcomes = learningOutcomes.value; // New Field
        const courseType = document.querySelector('input[name="courseType"]:checked').value;
        const duration = contentDuration.value;
        const offerCertificate = document.getElementById('offerCertificate').checked;
        const mediaFile = document.getElementById('mediaFile').files[0];
        const outlineText = document.getElementById('courseOutline').value;
        const outlineFileObj = document.getElementById('outlineFile').files[0];

        if (!title || !category || !target || !duration || !mediaFile) {
            alert('Please fill in all required fields and upload a file.');
            return;
        }

        const btn = document.getElementById('submitContent');
        btn.innerText = "Uploading..."; btn.disabled = true;

        try {
            // **REAL WORLD STEP:** Upload mediaFile and outlineFile to Storage here
            // const mediaUrl = await uploadToStorage(mediaFile, currentUser.uid, currentContentType); 
            // const outlineUrl = outlineFileObj ? await uploadToStorage(outlineFileObj, currentUser.uid, 'outline') : null;
            
            // Placeholder URLs for demo
            const mediaUrl = `https://storage-placeholder.com/${currentContentType}-${new Date().getTime()}`;
            const outlineUrl = outlineFileObj ? `https://outline-placeholder.com/${new Date().getTime()}` : null;
            const thumbnailUrl = 'https://images.unsplash.com/photo-1541701494587-c5b141459c3a?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';


            await addDoc(collection(db, "meetversity"), {
                contentType: currentContentType,
                title,
                category,
                targetAudience: target,
                learningOutcomes: outcomes,
                courseType,
                duration,
                offerCertificate,
                mediaUrl, // URL to the main content
                outlineText: outlineText, // Outline description text
                outlineUrl: outlineUrl, // URL to the outline PDF (if uploaded)
                creatorId: currentUser.uid,
                creatorName: currentUser.displayName,
                thumbnailUrl: thumbnailUrl,
                views: 0,
                downloads: currentContentType === 'document' ? 0 : null,
                createdAt: serverTimestamp()
            });
            
            alert(`${currentContentType === 'long-video' ? 'Course' : currentContentType === 'quick-video' ? 'Quick video' : 'Document'} created successfully!`);
            closeCreateModalHandler();
            
        } catch(e) {
            console.error("Error creating content:", e);
            alert("Error creating content. Please try again.");
        } finally {
            btn.innerText = "Create Content"; btn.disabled = false;
        }
    }

    // Event Listeners
    function setupMeetversityEventListeners() {
      createContentBtn.addEventListener('click', () => {
        createContentModal.style.display = 'flex';
        setContentType(currentContentType); // Ensure correct form is shown on open
      });

      closeCreateModal.addEventListener('click', closeCreateModalHandler);
      cancelCreate.addEventListener('click', closeCreateModalHandler);
      createContentModal.addEventListener('click', (e) => {
        if (e.target === createContentModal) {
          closeCreateModalHandler();
        }
      });
      
      contentTypeTabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const type = tab.getAttribute('data-type');
          setContentType(type);
          contentTypeTabs.forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
        });
      });

      contentTypeCards.forEach(card => {
        card.addEventListener('click', () => {
          const type = card.getAttribute('data-type');
          setContentType(type);
          createContentModal.style.display = 'flex';
          contentTypeTabs.forEach(tab => {
            tab.classList.remove('active');
            if (tab.getAttribute('data-type') === type) {
              tab.classList.add('active');
            }
          });
        });
      });

      mediaUpload.addEventListener('click', () => mediaFile.click());
      mediaFile.addEventListener('change', handleMediaUpload);
      outlineUpload.addEventListener('click', () => outlineFile.click());
      submitContent.addEventListener('click', submitContentHandler);
    }

    // Notifications count function (reused from Meetrader)
    function setupNotificationsCount() {
        const q = query(collection(db, "notifications"), where("targetUserId", "==", currentUser.uid), where("read", "==", false));
        onSnapshot(q, (snap) => {
            const badge = document.getElementById('unreadBadge');
            if(!snap.empty) {
                badge.style.display = 'flex';
                badge.innerText = snap.size;
            } else {
                badge.style.display = 'none';
            }
        });
    }

    window.auth = auth;
</script>
</body>
</html>
