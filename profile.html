<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Upload to Cloudinary</title>
</head>
<body>
<h2>Upload to Cloudinary</h2>
<input type="file" id="fileInput" />
<button id="uploadBtn">Upload</button>

<script>
const backendUrl = "https://super-robot-4jwqjpv5j76pc479-5000.app.github.dev"; // your Codespace backend

document.getElementById("uploadBtn").addEventListener("click", async () => {
  const fileInput = document.getElementById("fileInput");
  if (!fileInput.files.length) {
    alert("Select a file first!");
    return;
  }

  const file = fileInput.files[0];

  try {
    // 1. Get signature from backend
    const sigRes = await fetch(`${backendUrl}/signature`);
    const sigData = await sigRes.json();
    const timestamp = sigData.timestamp;
    const signature = sigData.signature;

    // 2. Prepare FormData for Cloudinary
    const formData = new FormData();
    formData.append("file", file);
    formData.append("api_key", "767477973776429"); // your Cloudinary API Key
    formData.append("timestamp", timestamp);
    formData.append("signature", signature);

    // 3. Send file to Cloudinary
    const cloudinaryUrl = "https://api.cloudinary.com/v1_1/dcwof2ngn/video/upload"; // video upload endpoint
    const uploadRes = await fetch(cloudinaryUrl, {
      method: "POST",
      body: formData
    });

    const result = await uploadRes.json();
    console.log("Upload result:", result);
    alert("Upload successful! Check console.");
  } catch (err) {
    console.error("Upload error:", err);
    alert("Error uploading file.");
  }
});
</script>
</body>
</html>
